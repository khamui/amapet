@for (answer of answers; track answer._id) {
  <div class="mb-2 mt-4">
    <span class="text-xs text-500 hover:text-700">{{ answer.ownerName }}</span
    ><span class="mx-2 text-xs text-500 hover:text-700">{{
      answer.created_at | dateAgo
    }}</span>
    @if (answer.modded_at && !answer.deleted) {
      <span class="mr-3 text-xs font-italic">(edited)</span>
    } @else if (answer.deleted) {
      <span class="mr-3 text-xs font-italic">(deleted)</span>
    }
    @if (currentUserId === answer.ownerId && !answer.deleted) {
      <span class="text-xs">
        <button
          type="button"
          class="btn__link mx-1"
          (click)="toggleEditForm(answer)"
        >
          Edit
        </button>
        <button
          type="button"
          class="btn__link mx-1"
          (click)="handleDelete(answer)"
        >
          Delete
        </button>
      </span>
    }
  </div>
  @if (!answer.deleted) {
    <div class="flex mb-2">
      <div class="text-sm">
        <ama-vote
          [upvotes]="answer?.upvotes || []"
          [downvotes]="answer?.downvotes || []"
          (upvoteSubmit)="handleUpvoteAnswer(answer)"
          (downvoteSubmit)="handleDownvoteAnswer(answer)"
        ></ama-vote>
      </div>
      <p-divider layout="vertical"></p-divider>
      <div class="flex flex-col justify-between w-full">
        @if (answerInEditing?._id === answer?._id && !answer.deleted) {
          <div class="my-3">
            <ama-texteditor
              submitButtonText="Save"
              cancelButtonText="Cancel"
              [data]="answer"
              [initialValue]="answer.answerText"
              [editorHeightCss]="{ height: '4rem' }"
              (submit)="submitAnswerUpdate($event)"
              (cancel)="closeAnswerForm()"
            ></ama-texteditor>
          </div>
        } @else {
          @if (!answer.deleted) {
            <div
              class="text-sm font-bold my-3"
              [innerHtml]="answer.answerText"
            ></div>
          }
        }
        @if (isLoggedIn) {
          <div class="mt-3">
            <p-toggleButton
              #subAnswerEditor
              class="mx-1 text-xs p-1"
              [styleClass]="
                (isLoggedIn && !answer.deleted ? '' : 'hidden')
              "
              onLabel="Cancel"
              offLabel="Reply"
              size="small"
            ></p-toggleButton>
          </div>
          @if (subAnswerEditor.checked) {
            <div class="my-3">
              <ama-texteditor
                [data]="answer"
                [editorButtonElement]="subAnswerEditor"
                (submit)="submitAnswer($event)"
              ></ama-texteditor>
            </div>
          }
        } @else {
          <div class="mt-3">
            <p-button
              label="Login to reply"
              icon="pi pi-sign-in"
              class="mr-2 primary-50"
              styleClass="p-button-warning"
              size="small"
              [outlined]="true"
              (onClick)="router.navigate(['signin'])"
            ></p-button>
          </div>
        }
        @if (answer?.children?.length || 0 > 0) {
          <ama-answers
            [questionId]="questionId"
            [circleId]="circleId"
            [answers]="answer.children"
          ></ama-answers>
        }
      </div>
    </div>
  }
}
